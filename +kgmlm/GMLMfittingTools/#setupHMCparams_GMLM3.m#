function [HMC_settings] = setupHMCparams_GMLM3(nWarmup, nTotal, debugSettings)
HMC_settings.DEBUG = debugSettings;

%% covariance estimation
if(nargin < 3 || ~debugSettings)
    T_preWarmup_e = 1000;
    T_preWarmup_M = 6000;

    
    HMC_settings.M_est.params.samples = 500:50:max(1e2,nWarmup-T_preWarmup_M);

    HMC_settings.M_est.params.startUsingMBank = min(nWarmup,  HMC_settings.M_est.params.samples(1) + 1001);
    
    HMC_settings.M_est.hyperparams.first_sample  = 501;
    HMC_settings.M_est.hyperparams.samples       = HMC_settings.M_est.params.samples(HMC_settings.M_est.params.samples > HMC_settings.M_est.hyperparams.first_sample);
    
    HMC_settings.verbose = false;
    
    HMC_settings.stepSize.schedule   = [2 HMC_settings.M_est.params.startUsingMBank  nWarmup-T_preWarmup_e+1];
    
    HMC_settings.showPlots = false;
    
    HMC_settings.M_est.params.selectEvery = 1;
    
    
    HMC_settings.HMC_step.nSamples_init = HMC_settings.M_est.params.startUsingMBank;
    HMC_settings.HMC_step.maxSteps_init  = 500;
    HMC_settings.HMC_step.maxSteps  = 100;
else
    nWarmup = 2000;
    nTotal  = 8000+nWarmup;

    T_preWarmup_e = 1000;
    T_preWarmup_M = 1000;
    
    
    HMC_settings.M_est.params.first_sample  = 11;
    
    HMC_settings.M_est.params.samples = 30:50:(nWarmup - T_preWarmup_M);
    
    HMC_settings.M_est.params.startUsingMBank = 531;

    HMC_settings.M_est.hyperparams.first_sample = 11;
    HMC_settings.M_est.hyperparams.samples = HMC_settings.M_est.params.samples;
    
    
    HMC_settings.stepSize.schedule   = [2 HMC_settings.M_est.params.startUsingMBank  nWarmup-T_preWarmup_e+1];
    
    HMC_settings.verbose = true;
    HMC_settings.showPlots = true;
    
    HMC_settings.M_est.params.selectEvery = 1;
    
    HMC_settings.HMC_step.nSamples_init = HMC_settings.M_est.params.startUsingMBank;
    HMC_settings.HMC_step.maxSteps_init  = 200;
    HMC_settings.HMC_step.maxSteps  = 100;
end

%%
HMC_settings.M_est.hyperparams.scale = 1;
HMC_settings.M_est.params.max_sv_T   = [];%1./0.01^2;
HMC_settings.M_est.params.max_sv_V   = [];%1./0.01^2
HMC_settings.M_est.params.scale_T    = 0.5;
HMC_settings.M_est.params.scale_V    = 0.25;
HMC_settings.M_est.params.scale_H    = 1;
HMC_settings.M_est.params.useLaplace = true;

HMC_settings.MH_scale.rho = -0.9;
HMC_settings.MH_scale.sig = 0.2;
HMC_settings.MH_scale.N            = 10;
HMC_settings.MH_scale.sample_every = 1;

HMC_settings.HMC_step.stepL     = 1.0;

HMC_settings.stepSize.e_0 = 1e-1;
HMC_settings.stepSize.delta  = 0.8;
HMC_settings.stepSize.gamma = 0.05;
HMC_settings.stepSize.kappa = 0.75;
HMC_settings.stepSize.t_0   = 10;
HMC_settings.stepSize.mu    = log(10*HMC_settings.stepSize.e_0);
ig = nanstd(T_1_samples(1,:));

HMC_settings.nWarmup = nWarmup;
HMC_settings.nTotal  = nTotal;


